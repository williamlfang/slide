read_html(encoding="GB18030") %>%
html_nodes(".art_main  p") %>%
html_text()
main = paste(main, collapse = '\n                                                                                              \n')
all <- list(link, title, date, main)   ## all information: link, title, date, main
return(all)
}
inf = lapply(link, article)
inff[[1]]
inf[[1]]
url1 <- "http://stock.10jqka.com.cn/stocknews_list/index_1.shtml"
url2 <- "http://stock.10jqka.com.cn/stocknews_list/index_2.shtml"
#############################################################
link1 <- url1 %>%
read_html(encoding="GB18030") %>%
html_nodes(".list_item  h2 a") %>%
html_attr("href")
link2 <- url2 %>%
read_html(encoding="GB18030") %>%
html_nodes(".list_item  h2 a") %>%
html_attr("href")
link <- c(link1, link2)
inf = lapply(link, article)
library(rvest)
article <- function(x){
link <- x
title <- x %>%
read_html(encoding="GB18030") %>%
html_nodes("#J_article  h1") %>%
html_text()
date <- x %>%
read_html(encoding="GB18030") %>%
html_nodes(".art_info  #pubtime_baidu") %>%
html_text()
main <- x %>%
read_html(encoding="GB18030") %>%
html_nodes(".art_main  p") %>%
html_text()
main = paste(main, collapse = '\n                                                                                              \n')
all <- list(link, title, date, main)   ## all information: link, title, date, main
return(all)
}
url1 <- "http://stock.10jqka.com.cn/stocknews_list/index_1.shtml"
url2 <- "http://stock.10jqka.com.cn/stocknews_list/index_2.shtml"
#############################################################
link1 <- url1 %>%
read_html(encoding="GB18030") %>%
html_nodes(".list_item  h2 a") %>%
html_attr("href")
link2 <- url2 %>%
read_html(encoding="GB18030") %>%
html_nodes(".list_item  h2 a") %>%
html_attr("href")
link1 <- url1 %>%
read_html(encoding="GB18030") %>%
html_nodes(".list_item  h2 a") %>%
html_attr("href")
link1 <- url1 %>%
read_html(encoding="GB18030") %>%
html_nodes(".list_item  h2 a") %>%
html_attr("href")
link1
link2 <- url2 %>%
read_html(encoding="GB18030") %>%
html_nodes(".list_item  h2 a") %>%
html_attr("href")
url1 <- "http://stock.10jqka.com.cn/stocknews_list/index_1.shtml"
url2 <- "http://stock.10jqka.com.cn/stocknews_list/index_2.shtml"
url1 <- "http://stock.10jqka.com.cn/stocknews_list/index_1.shtml"
url2 <- "http://stock.10jqka.com.cn/stocknews_list/index_2.shtml"
url1 <- "http://stock.10jqka.com.cn/stocknews_list/index_1.shtml"
url2 <- "http://stock.10jqka.com.cn/stocknews_list/index_2.shtml"
link1 <- url1 %>%
read_html(encoding="GB18030") %>%
html_nodes(".list_item  h2 a") %>%
html_attr("href")
link2 <- url2 %>%
read_html(encoding="GB18030") %>%
html_nodes(".list_item  h2 a") %>%
html_attr("href")
url2
link2 <- url2 %>%
read_html(encoding="GB18030") %>%
html_nodes(".list_item  h2 a") %>%
html_attr("href")
link2
url1 <- "http://stock.10jqka.com.cn/stocknews_list/index_1.shtml"
url2 <- "http://stock.10jqka.com.cn/stocknews_list/index_2.shtml"
#############################################################
link1 <- url1 %>%
read_html(encoding="GB18030") %>%
html_nodes(".list_item  h2 a") %>%
html_attr("href")
url1 <- "http://stock.10jqka.com.cn/stocknews_list/index_1.shtml"
url2 <- "http://stock.10jqka.com.cn/stocknews_list/index_2.shtml"
#############################################################
link1 <- url1 %>%
read_html(encoding="GB18030") %>%
html_nodes(".list_item  h2 a") %>%
html_attr("href")
link2 <- url2 %>%
read_html(encoding="GB18030") %>%
html_nodes(".list_item  h2 a") %>%
html_attr("href")
link <- c(link1, link2)
inf = lapply(link, article)
library(rvest)
url <- "http://stock.stockstar.com/report/"
link <- url %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
article <- function(x){
link <- x
title  <- x %>%
read_html(encoding="GB18030") %>%
html_nodes("h1") %>%
html_text()
page.numbers <- x %>%
yhji
{}
)
article <- function(x){
link <- x
title  <- x %>%
read_html(encoding="GB18030") %>%
html_nodes("h1") %>%
html_text()
page.numbers <- x %>%
read_html(encoding="GB18030")  %>%
html_nodes("#Page a") %>%
html_text() %>%
as.numeric()
page.numbers <- page.numbers[1:length(page.numbers)-1]
date <- x %>%
read_html(encoding="GB18030") %>%
html_nodes("#pubtime_baidu") %>%
html_text()
url0 <- strsplit(x, "\\.shtml")
url.new <- rep( NA, length(page.numbers) )
for ( i in 1:length(page.numbers) ){
url.new[i] <- paste(url0, "_", i, ".shtml", sep="")
}
text <- function(x){
text <- x %>%
read_html(encoding="GB18030")  %>%
html_nodes("#container-article  p") %>%
html_text()
text <- text[3:length(text)-1]
}
main <- lapply(url.new, text)
file <-  x %>%
read_html(encoding="GB18030") %>%
html_nodes("#container-article  p  a") %>%
html_attr("href") %>%
.[1]
file.link <-  x %>%
read_html(encoding="GB18030") %>%
html_nodes("#container-article  p  a") %>%
html_text() %>%
.[1]
tidai <- function(x){
# y = paste(x, collapse = '\t ============================================================================ \t')
y = paste(x, collapse = '\n                                                                                 \n')
return(y)
}
)]]
url <- "http://stock.stockstar.com/report/"
link <- url %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link
url <- "http://stock.stockstar.com/report/"
link <- url %>%
read_html(encoding="GB18030") %>%
html_nodes(".p_ding  li  a") %>%
html_attr("href")
link
article <- function(x){
link <- x
title  <- x %>%
read_html(encoding="GB18030") %>%
html_nodes("h1") %>%
html_text()
page.numbers <- x %>%
read_html(encoding="GB18030")  %>%
html_nodes("#Page a") %>%
html_text() %>%
as.numeric()
page.numbers <- page.numbers[1:length(page.numbers)-1]
date <- x %>%
read_html(encoding="GB18030") %>%
html_nodes("#pubtime_baidu") %>%
html_text()
url0 <- strsplit(x, "\\.shtml")
url.new <- rep( NA, length(page.numbers) )
for ( i in 1:length(page.numbers) ){
url.new[i] <- paste(url0, "_", i, ".shtml", sep="")
}
text <- function(x){
text <- x %>%
read_html(encoding="GB18030")  %>%
html_nodes("#container-article  p") %>%
html_text()
text <- text[3:length(text)-1]
}
main <- lapply(url.new, text)
file <-  x %>%
read_html(encoding="GB18030") %>%
html_nodes("#container-article  p  a") %>%
html_attr("href") %>%
.[1]
file.link <-  x %>%
read_html(encoding="GB18030") %>%
html_nodes("#container-article  p  a") %>%
html_text() %>%
.[1]
tidai <- function(x){
# y = paste(x, collapse = '\t ============================================================================ \t')
y = paste(x, collapse = '\n                                                                                 \n')
return(y)
}
main <- main %>%
sapply(., tidai) %>%
as.character() %>%
gsub("个股资料|操作策略|咨询高手|实盘买卖", "", .) %>%
gsub("(\\（|\\）)"," ..........................................................", .)
all <- list(link, title, date, main, file, file.link)   ## all information: link, title, date, main
return(all)
}
inf = lapply(link, article)
inf = lapply(link, article)
link
link = link[1:2]
inf = lapply(link, article)
inf[[1]]
library(rvest)
url <- "http://stock.stockstar.com/report/"
link <- url %>%
read_html(encoding="GB18030") %>%
html_nodes(".p_ding  li  a") %>%
html_attr("href")
article <- function(x){
link <- x
title  <- x %>%
read_html(encoding="GB18030") %>%
html_nodes("h1") %>%
html_text()
page.numbers <- x %>%
read_html(encoding="GB18030")  %>%
html_nodes("#Page a") %>%
html_text() %>%
as.numeric()
page.numbers <- page.numbers[1:length(page.numbers)-1]
date <- x %>%
read_html(encoding="GB18030") %>%
html_nodes("#pubtime_baidu") %>%
html_text()
url0 <- strsplit(x, "\\.shtml")
url.new <- rep( NA, length(page.numbers) )
for ( i in 1:length(page.numbers) ){
url.new[i] <- paste(url0, "_", i, ".shtml", sep="")
}
text <- function(x){
text <- x %>%
read_html(encoding="GB18030")  %>%
html_nodes("#container-article  p") %>%
html_text()
text <- text[3:length(text)-1]
}
main <- lapply(url.new, text)
file <-  x %>%
read_html(encoding="GB18030") %>%
html_nodes("#container-article  p  a") %>%
html_attr("href") %>%
.[1]
file.link <-  x %>%
read_html(encoding="GB18030") %>%
html_nodes("#container-article  p  a") %>%
html_text() %>%
.[1]
tidai <- function(x){
# y = paste(x, collapse = '\t ============================================================================ \t')
y = paste(x, collapse = '\n                                                                                 \n')
return(y)
}
main <- main %>%
sapply(., tidai) %>%
as.character() %>%
gsub("个股资料|操作策略|咨询高手|实盘买卖", "", .) %>%
gsub("(\\（|\\）)"," ..........................................................", .)
all <- list(link, title, date, main, file, file.link)   ## all information: link, title, date, main
return(all)
}
inf = lapply(link, article)
inf[[1]][[3]]
inf[[1]][[5]]
inf[[1]][[6]]
link
url1 <- "http://stock.stockstar.com/list/3489_1.shtml"
url2 <- "http://stock.stockstar.com/list/3489_2.shtml"
url3 <- "http://stock.stockstar.com/list/3489_3.shtml"
link1 <- url1 %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link2 <- url2 %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link3 <- url3 %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link <- c(link1, link2, link3)
link
url1 <- "http://stock.stockstar.com/list/3489_1.shtml"
url2 <- "http://stock.stockstar.com/list/3489_2.shtml"
link1 <- url1 %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link2 <- url2 %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link <- c(link1, link2)
link
url1 <- "http://stock.stockstar.com/list/3489_1.shtml"
url2 <- "http://stock.stockstar.com/list/3489_2.shtml"
url3 <- "http://stock.stockstar.com/list/3489_3.shtml"
link1 <- url1 %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link2 <- url2 %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link3 <- url3 %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link <- c(link1, link2, link3)
link
url1 <- "http://stock.stockstar.com/list/4019_1.shtml"
url2 <- "http://stock.stockstar.com/list/4019_2.shtml"
link1 <- url1 %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link2 <- url2 %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link <- c(link1, link2)
inf = lapply(link, article)
url1 <- "http://stock.stockstar.com/list/4019_1.shtml"
url2 <- "http://stock.stockstar.com/list/4019_2.shtml"
link1 <- url1 %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link2 <- url2 %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link <- c(link1, link2)
link
link <- c(link1, link2)
x = link[1]
x
main <- x %>%
read_html(encoding="GB18030")  %>%
html_nodes("#container-article  p") %>%
html_text()  %>%
as.character() %>%
gsub("个股资料|操作策略|咨询高手|实盘买卖", "", .) %>%
gsub("(\\（|\\）)"," ..........................................................", .)
main
```{r echo=FALSE, warning=FALSE, message=FALSE}
article <- function(x){
link <- x
title  <- x %>%
read_html(encoding="GB18030") %>%
html_nodes("h1") %>%
html_text()
date <- x %>%
read_html(encoding="GB18030") %>%
html_nodes("#pubtime_baidu") %>%
html_text()
main <- x %>%
read_html(encoding="GB18030")  %>%
html_nodes("#container-article  p") %>%
html_text()  %>%
as.character() %>%
gsub("个股资料|操作策略|咨询高手|实盘买卖", "", .) %>%
gsub("(\\（|\\）)"," ..........................................................", .)
file <-  x %>%
read_html(encoding="GB18030") %>%
html_nodes("#container-article  p  a") %>%
html_attr("href") %>%
.[1]
file.link <-  x %>%
read_html(encoding="GB18030") %>%
html_nodes("#container-article  p  a") %>%
html_text() %>%
.[1]
all <- list(link, title, date, main, file, file.link)   ## all information: link, title, date, main
return(all)
}
link
link = link[1:2]
inf = lapply(link, article)
inf
inf[[1]]
```
url1 <- "http://stock.stockstar.com/list/4019_1.shtml"
url2 <- "http://stock.stockstar.com/list/4019_2.shtml"
link1 <- url1 %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link2 <- url2 %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link <- c(link1, link2)
article <- function(x){
link <- x
title  <- x %>%
read_html(encoding="GB18030") %>%
html_nodes("h1") %>%
html_text()
date <- x %>%
read_html(encoding="GB18030") %>%
html_nodes("#pubtime_baidu") %>%
html_text()
main <- x %>%
read_html(encoding="GB18030")  %>%
html_nodes("#container-article  p") %>%
html_text()  %>%
as.character() %>%
gsub("个股资料|操作策略|咨询高手|实盘买卖", "", .) %>%
gsub("(\\（|\\）)"," ..........................................................", .)
file <-  x %>%
read_html(encoding="GB18030") %>%
html_nodes("#container-article  p  a") %>%
html_attr("href") %>%
.[1]
file.link <-  x %>%
read_html(encoding="GB18030") %>%
html_nodes("#container-article  p  a") %>%
html_text() %>%
.[1]
all <- list(link, title, date, main, file, file.link)   ## all information: link, title, date, main
return(all)
}
inf = lapply(link, article)
url1 <- "http://stock.stockstar.com/list/4019_1.shtml"
url2 <- "http://stock.stockstar.com/list/4019_2.shtml"
link1 <- url1 %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link2 <- url2 %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link <- c(link1, link2)
article <- function(x){
link <- x
title  <- x %>%
read_html(encoding="GB18030") %>%
html_nodes("h1") %>%
html_text()
date <- x %>%
read_html(encoding="GB18030") %>%
html_nodes("#pubtime_baidu") %>%
html_text()
main <- x %>%
read_html(encoding="GB18030")  %>%
html_nodes("#container-article  p") %>%
html_text()  %>%
as.character() %>%
gsub("个股资料|操作策略|咨询高手|实盘买卖", "", .) %>%
gsub("(\\（|\\）)"," ..........................................................", .)
file <-  x %>%
read_html(encoding="GB18030") %>%
html_nodes("#container-article  p  a") %>%
html_attr("href") %>%
.[1]
file.link <-  x %>%
read_html(encoding="GB18030") %>%
html_nodes("#container-article  p  a") %>%
html_text() %>%
.[1]
all <- list(link, title, date, main, file, file.link)   ## all information: link, title, date, main
return(all)
}
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
link2 <- url2 %>%
read_html(encoding="GB18030") %>%
html_nodes(".listtable  li  a") %>%
html_attr("href")
inf = lapply(link, article)
setwd("/media/william/Storage/slidify/publish")
library(slidify)
publish(user = "williamlfang", repo = "slide", host = 'github')
